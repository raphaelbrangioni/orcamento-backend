# Valores para deploy simples no namespace orcamento
replicaCount: 1

image:
  repository: rbrangioni/orcamento-backend
  pullPolicy: IfNotPresent
  tag: "1.0.8"

service:
  type: ClusterIP
  port: 8045

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi

# Propriedades necessárias para o template
imagePullSecrets: []
podAnnotations: {}
podSecurityContext: {}
securityContext: {}
nodeSelector: {}
tolerations: []
affinity: {}

# Service Account
serviceAccount:
  create: false
  annotations: {}
  name: ""

# Configurações da aplicação
app:
  database:
    host: mysql-external.orcamento.svc.cluster.local
    port: 3306
    name: orcamento
    username: root
    password: admin.2011
    
  cors:
    allowedOrigins: "http://orcamento.local,http://api.orcamento.local,http://localhost:8080,*"
    
  jwt:
    expirationMs: 1800000
    
  mail:
    host: smtp.gmail.com
    port: 587
    username: noreplay.meuorcamento@gmail.com
    password: eivo ottt pjzn vsdb
    from: noreplay.meuorcamento@gmail.com

# Health checks otimizados (já testados)
livenessProbe:
  httpGet:
    path: /actuator/health
    port: http
  initialDelaySeconds: 60
  periodSeconds: 30
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /actuator/health
    port: http
  initialDelaySeconds: 45
  periodSeconds: 15
  timeoutSeconds: 5
  failureThreshold: 3

configMap:
  create: true
  data:
    application.yaml: |
      spring:
        mvc:
          cors:
            mappings:
              "[/**]":
                allowed-origins: "http://orcamento.local,http://api.orcamento.local,http://localhost:8080,*"
                allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
                allowed-headers: "*"
                exposed-headers: "*"
                allow-credentials: true
                max-age: 3600
        application:
          name: orcamento
        devtools:
          restart:
            enabled: false
        datasource:
          driver-class-name: com.mysql.cj.jdbc.Driver
          url: jdbc:mysql://mysql-external.orcamento.svc.cluster.local:3306/orcamento?createDatabaseIfNotExist=true&allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=UTC
          username: root
          password: admin.2011
          hikari:
            minimum-idle: 5
            maximum-pool-size: 20
            idle-timeout: 30000
            max-lifetime: 1800000
            connection-timeout: 30000
            pool-name: HikariPool-Orcamento
        jpa:
          database-platform: org.hibernate.dialect.MySQLDialect
          hibernate:
            ddl-auto: update
          show-sql: false
          properties:
            hibernate:
              format_sql: true
              jdbc:
                time_zone: UTC
        jackson:
          date-format: yyyy-MM-dd
          time-zone: UTC
          deserialization:
            ADJUST_DATES_TO_CONTEXT_TIME_ZONE: false
        servlet:
          multipart:
            max-file-size: 100MB
            max-request-size: 100MB
        mail:
          host: smtp.gmail.com
          port: 587
          username: noreplay.meuorcamento@gmail.com
          password: eivo ottt pjzn vsdb
          properties:
            mail:
              smtp:
                auth: true
                starttls:
                  enable: true
          from: noreplay.meuorcamento@gmail.com
      server:
        port: 8045
      springdoc:
        api-docs:
          enabled: true
          path: /v3/api-docs
        swagger-ui:
          path: /swagger-ui.html
          enabled: true
      logging:
        level:
          org.springframework.security: INFO
      jwt:
        expiration:
          ms: 1800000
      file:
        upload-dir: ./uploads
      management:
        endpoints:
          web:
            exposure:
              include: health,info,prometheus




